summary: Network IDS, IPS, and security monitoring engine
web-url: https://suricata-ids.org
git-url: https://github.com/OISF/suricata
src-url: https://www.openinfosecfoundation.org/download/suricata-7.0.0.tar.gz
src-sha: 7bcd1313118366451465dc3f8385a3f6aadd084ffe44dd257dda8105863bb769
license: GPL-2.0-or-later
dep-pkg: jansson file libnet libpcap libyaml lz4 pcre libiconv libglob
bsystem: configure cargo

# void endgrent(void) __INTRODUCED_IN(26);
sdk-api: 26

install: |
    export CARGO_BUILD_TARGET="$RUST_TARGET"

    sed_in_place "/host_triplet = /c host_triplet = $RUST_TARGET" "$PACKAGE_BSCRIPT_DIR/rust/Makefile.in" &&
    sed_in_place '/RUST_LDADD="${RUST_SURICATA_LIB}/i RUST_SURICATA_LIB=$(echo "$RUST_SURICATA_LIB" | sed "s/armv7a/armv7/")' "$PACKAGE_BSCRIPT_DIR/configure" &&
    run rustup target add "$RUST_TARGET" &&
    configure \
        --enable-pie \
        ac_cv_lib_pthread_pthread_create=yes \
        ac_cv_lib_jansson_json_dump_callback=yes \
        ac_cv_lib_pcap_pcap_open_live=yes
