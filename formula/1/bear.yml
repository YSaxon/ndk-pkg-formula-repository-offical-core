summary: Generate compilation database for clang tooling
git-url: https://github.com/rizsotto/Bear.git
src-url: https://github.com/rizsotto/Bear/archive/3.0.17.tar.gz
src-url: dir:///home/fpliu/Bear-3.0.17
src-sha: 107f94e045d930e88f5f5b4b484c8df1bf4834722943525765c271e0b5b34b78
license: GPL-3.0-or-later
dep-pkg: fmt grpc nlohmann-json spdlog
dep-upp: pkg-config
bsystem: cmake

# spawn.h: int posix_spawnp(pid_t* __pid, const char* __file, const posix_spawn_file_actions_t* __actions, const posix_spawnattr_t* __attr, char* const __argv[], char* const __env[]) __INTRODUCED_IN(28);
sdk-api: 28

dopatch: |
    #sed_in_place '/-DCMAKE_PREFIX_PATH/c \            -DCMAKE_FIND_ROOT_PATH:PATH=${CMAKE_FIND_ROOT_PATH}' CMakeLists.txt
    #sed_in_place '/HAVE_CONFSTR/c set(HAVE_CONFSTR 1)' source/CMakeLists.txt
    cat >> include.h <<EOF
#include<stdlib.h>
#include<string.h>
#define _CS_PATH 10
#define confstr(name, buf, len) strcpy(buf, "/bin:/usr/bin")
EOF

install: |
    cmakew \
        -DENABLE_UNIT_TESTS=OFF \
        -DENABLE_FUNC_TESTS=OFF
