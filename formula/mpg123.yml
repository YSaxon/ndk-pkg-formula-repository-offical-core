summary: MP3 player
git-url: https://github.com/madebr/mpg123
web-url: https://www.mpg123.de/
src-url: https://www.mpg123.de/download/mpg123-1.32.0.tar.bz2
src-sha: 23d4629e30a59a6b0e05b39283f78b8e261e70e9c2673b3c1179718b393aec01
license: LGPL-2.1-only
dep-pkg: sdl2
bsystem: configure

install: |
    # https://github.com/android/ndk/issues/1862
    if [ "$ANDROID_NDK_VERSION" = '25.2.9519653' ] ; then
        export CFLAGS="$(printf '%s\n' "$CFLAGS" | sed 's|-Os|-O3|g')"
    fi

    unset CPU

    case $TARGET_ANDROID_ARCH in
        armv7a)  CPU=neon   ;;
        aarch64) CPU=neon64 ;;
        i686)    CPU=x86    ;;
        x86_64)  CPU=x86-64 ;;
    esac

    configure \
        --enable-debug=no \
        --enable-ipv6=yes \
        --with-module-suffix=.so \
        --with-cpu="$CPU"
